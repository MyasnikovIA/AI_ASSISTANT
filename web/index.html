<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>AI Assistant - –õ–æ–∫–∞–ª—å–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å RAG</title>
    <title>AI Assistant - –õ–æ–∫–∞–ª—å–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å RAG</title>


    <link rel="stylesheet" type="text/css" href="https://www.jeasyui.com/easyui/themes/default/easyui.css">
    <link rel="stylesheet" type="text/css" href="https://www.jeasyui.com/easyui/themes/icon.css">
    <link rel="stylesheet" type="text/css" href="https://www.jeasyui.com/easyui/themes/color.css">
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="text/javascript" src="https://www.jeasyui.com/easyui/jquery.easyui.min.js"></script>

    <link rel="stylesheet" type="text/css" href="/css/style.css">
    <!-- –ó–∞–≥—Ä—É–∑–∫–∞ app.js –ø–æ—Å–ª–µ jQuery –∏ EasyUI -->
    <script type="text/javascript" src="/js/app.js"></script>

</head>
<body class="easyui-layout">

<!-- –°–µ–≤–µ—Ä–Ω–∞—è –ø–∞–Ω–µ–ª—å - –∑–∞–≥–æ–ª–æ–≤–æ–∫ -->
<div data-options="region:'north',border:false" style="height:60px;background:#2d3e50;padding:10px">
    <h1 style="color:white;margin:0;display:inline-block">ü§ñ AI Assistant</h1>
    <span style="color:#ccc;margin-left:20px">–õ–æ–∫–∞–ª—å–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å RAG –∏ –ø–æ—Ç–æ–∫–æ–≤—ã–º –≤—ã–≤–æ–¥–æ–º</span>
    <div style="float:right;margin-top:10px">
        <span id="status" class="status-connected">‚óè –ü–æ–¥–∫–ª—é—á–µ–Ω–æ</span>
    </div>
</div>

<!-- –ó–∞–ø–∞–¥–Ω–∞—è –ø–∞–Ω–µ–ª—å - –º–µ–Ω—é -->
<div data-options="region:'west',split:true,title:'–ú–µ–Ω—é'" style="width:200px;padding:10px">
    <div class="easyui-accordion" style="width:100%;">
        <div title="–ß–∞—Ç" data-options="iconCls:'icon-comments'" style="padding:10px">
            <a href="javascript:void(0)" class="menu-link" onclick="showChat()">üí¨ –î–∏–∞–ª–æ–≥</a><br>
            <a href="javascript:void(0)" class="menu-link" onclick="showHistory()">üìú –ò—Å—Ç–æ—Ä–∏—è</a><br>
            <a href="javascript:void(0)" class="menu-link" onclick="clearHistory()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</a>
        </div>
        <div title="–ó–Ω–∞–Ω–∏—è" data-options="iconCls:'icon-book'" style="padding:10px">
            <a href="javascript:void(0)" class="menu-link" onclick="addKnowledge()">‚ûï –î–æ–±–∞–≤–∏—Ç—å</a><br>
            <a href="javascript:void(0)" class="menu-link" onclick="searchKnowledge()">üîç –ü–æ–∏—Å–∫</a><br>
            <a href="javascript:void(0)" class="menu-link" onclick="showStats()">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a>
        </div>
        <div title="–ú–æ–¥–µ–ª–∏" data-options="iconCls:'icon-cog'" style="padding:10px">
            <a href="javascript:void(0)" class="menu-link" onclick="manageModels()">üîÑ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</a><br>
            <a href="javascript:void(0)" class="menu-link" onclick="listModels()">üìã –°–ø–∏—Å–æ–∫</a><br>
            <a href="javascript:void(0)" class="menu-link" onclick="pullModel()">‚¨áÔ∏è –ó–∞–≥—Ä—É–∑–∏—Ç—å</a>
        </div>
        <div title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏" data-options="iconCls:'icon-tip'" style="padding:10px">
            <a href="javascript:void(0)" class="menu-link" onclick="toggleChatMode()">üîÑ –†–µ–∂–∏–º</a><br>
            <a href="javascript:void(0)" class="menu-link" onclick="toggleCache()">‚ö° –ö—ç—à</a><br>
            <a href="javascript:void(0)" class="menu-link" onclick="toggleSpeech()">üîä –û–∑–≤—É—á–∫–∞</a><br>
            <a href="javascript:void(0)" class="menu-link" onclick="managePrompts()">üìù –ü—Ä–æ–º–ø—Ç—ã</a>
        </div>
    </div>
</div>

<!-- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –æ–±–ª–∞—Å—Ç—å - –æ—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ -->
<div data-options="region:'center',title:'–î–∏–∞–ª–æ–≥'" style="padding:5px">
    <div id="chat-tabs" class="easyui-tabs" style="width:100%;height:100%">
        <div title="üí¨ –î–∏–∞–ª–æ–≥" style="padding:20px">
            <div style="margin-bottom:20px">
                    <textarea id="question-input" class="easyui-textbox"
                              data-options="multiline:true,prompt:'–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å...'"
                              style="width:100%;height:100px"></textarea>
                <div style="margin-top:10px">
                    <a href="javascript:void(0)" class="easyui-linkbutton"
                       onclick="sendQuestion()" data-options="iconCls:'icon-send'">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</a>
                    <a href="javascript:void(0)" class="easyui-linkbutton"
                       onclick="clearInput()" data-options="iconCls:'icon-clear'">–û—á–∏—Å—Ç–∏—Ç—å</a>
                    <span style="margin-left:20px">
                            <label><input type="checkbox" id="stream-toggle" checked> –ü–æ—Ç–æ–∫–æ–≤—ã–π –≤—ã–≤–æ–¥</label>
                        </span>
                </div>
            </div>

            <div class="easyui-panel" title="–û—Ç–≤–µ—Ç" style="width:100%;height:400px;padding:10px">
                <div id="response-area" style="height:100%;overflow-y:auto;font-family:'Courier New',monospace">
                    <div class="system-message">ü§ñ –ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ. –ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å...</div>
                </div>
            </div>
        </div>

        <div title="üìú –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞" style="padding:20px">
            <table id="history-grid" class="easyui-datagrid" style="width:100%;height:100%"
                   data-options="singleSelect:true,collapsible:true,rownumbers:true">
                <thead>
                <tr>
                    <th data-options="field:'role',width:100">–†–æ–ª—å</th>
                    <th data-options="field:'content',width:400">–°–æ–¥–µ—Ä–∂–∏–º–æ–µ</th>
                    <th data-options="field:'timestamp',width:150">–í—Ä–µ–º—è</th>
                </tr>
                </thead>
            </table>
        </div>

        <div title="‚ûï –î–æ–±–∞–≤–∏—Ç—å –∑–Ω–∞–Ω–∏—è" style="padding:20px">
            <div class="easyui-panel" style="padding:20px">
                <div style="margin-bottom:15px">
                    <label>–ò—Å—Ç–æ—á–Ω–∏–∫:</label>
                    <input id="knowledge-source" class="easyui-textbox" style="width:300px"
                           data-options="prompt:'–ù–∞–ø—Ä–∏–º–µ—Ä: –∫–Ω–∏–≥–∞, —Å—Ç–∞—Ç—å—è, –ª–∏—á–Ω—ã–π –æ–ø—ã—Ç'">
                </div>
                <div style="margin-bottom:15px">
                    <label>–¢–µ–∫—Å—Ç –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:</label>
                    <textarea id="knowledge-content" class="easyui-textbox"
                              data-options="multiline:true"
                              style="width:100%;height:200px"></textarea>
                </div>
                <div>
                    <a href="javascript:void(0)" class="easyui-linkbutton"
                       onclick="submitKnowledge()" data-options="iconCls:'icon-save'">–î–æ–±–∞–≤–∏—Ç—å</a>
                    <a href="javascript:void(0)" class="easyui-linkbutton"
                       onclick="clearKnowledgeForm()" data-options="iconCls:'icon-clear'">–û—á–∏—Å—Ç–∏—Ç—å</a>
                </div>
            </div>
        </div>

        <div title="üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞" style="padding:20px">
            <div id="stats-content" style="font-size:14px;line-height:1.6">
                <div class="easyui-panel" title="–°–∏—Å—Ç–µ–º–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞" style="margin-bottom:20px;padding:15px">
                    –ó–∞–≥—Ä—É–∑–∫–∞...
                </div>
            </div>
        </div>
    </div>
</div>

<!-- –Æ–∂–Ω–∞—è –ø–∞–Ω–µ–ª—å - —Å—Ç–∞—Ç—É—Å –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
<div data-options="region:'south',border:false" style="height:30px;background:#f0f0f0;padding:5px">
    <div style="float:left">
        <span id="model-info">–ú–æ–¥–µ–ª—å: –ó–∞–≥—Ä—É–∑–∫–∞...</span>
        <span style="margin-left:20px" id="mode-info">–†–µ–∂–∏–º: –ó–∞–≥—Ä—É–∑–∫–∞...</span>
    </div>
    <div style="float:right">
        <span id="doc-count">–î–æ–∫—É–º–µ–Ω—Ç–æ–≤: 0</span>
        <span style="margin-left:20px" id="memory-info">–ü–∞–º—è—Ç—å: 0%</span>
    </div>
</div>

<!-- –î–∏–∞–ª–æ–≥–æ–≤—ã–µ –æ–∫–Ω–∞ -->
<div id="model-dialog" class="easyui-dialog" title="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª—è–º–∏"
     style="width:600px;height:400px;padding:10px" data-options="closed:true,modal:true">
    <div id="model-tabs" class="easyui-tabs" style="width:100%;height:100%">
        <div title="–°–º–µ–Ω–∞ –º–æ–¥–µ–ª–∏" style="padding:20px">
            <div style="margin-bottom:15px">
                <label>–¢–µ–∫—É—â–∞—è –º–æ–¥–µ–ª—å:</label>
                <span id="current-model-name" style="font-weight:bold;margin-left:10px">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
            </div>
            <div style="margin-bottom:15px">
                <label>–í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å:</label>
                <select id="model-select" class="easyui-combobox" style="width:300px"></select>
            </div>
            <div>
                <a href="javascript:void(0)" class="easyui-linkbutton"
                   onclick="switchModel()">–°–º–µ–Ω–∏—Ç—å</a>
                <a href="javascript:void(0)" class="easyui-linkbutton"
                   onclick="refreshModels()">–û–±–Ω–æ–≤–∏—Ç—å</a>
            </div>
        </div>

        <div title="–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏" style="padding:20px">
            <div style="margin-bottom:15px">
                <label>–ù–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏:</label>
                <input id="new-model-name" class="easyui-textbox" style="width:300px"
                       data-options="prompt:'–Ω–∞–ø—Ä–∏–º–µ—Ä: llama2:7b'">
            </div>
            <div style="margin-bottom:15px">
                <label>–ü—Ä–∏–º–µ—Ä—ã –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π:</label>
                <div style="margin:10px 0;color:#666">
                    <div>‚Ä¢ deepseek-coder:6.7b</div>
                    <div>‚Ä¢ llama2:7b</div>
                    <div>‚Ä¢ mistral:7b</div>
                    <div>‚Ä¢ codellama:7b</div>
                    <div>‚Ä¢ phi:2.7b</div>
                </div>
            </div>
            <div>
                <a href="javascript:void(0)" class="easyui-linkbutton"
                   onclick="startModelPull()">–ù–∞—á–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É</a>
            </div>
            <div id="pull-progress" style="margin-top:20px;display:none">
                <div class="easyui-progressbar" style="width:100%"></div>
                <div id="pull-status" style="margin-top:10px"></div>
            </div>
        </div>
    </div>
</div>

<div id="prompt-dialog" class="easyui-dialog" title="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞–º–∏"
     style="width:700px;height:500px;padding:10px" data-options="closed:true,modal:true">
    <div class="easyui-tabs" style="width:100%;height:100%">
        <div title="–¢–µ–∫—É—â–∏–π –ø—Ä–æ–º–ø—Ç" style="padding:10px">
            <div style="margin-bottom:10px">
                <label>–†–µ–∂–∏–º:</label>
                <span id="current-prompt-mode" style="font-weight:bold;margin-left:10px"></span>
            </div>
            <textarea id="current-prompt-edit" class="easyui-textbox"
                      data-options="multiline:true"
                      style="width:100%;height:300px"></textarea>
            <div style="margin-top:10px">
                <a href="javascript:void(0)" class="easyui-linkbutton"
                   onclick="updateCurrentPrompt()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</a>
                <a href="javascript:void(0)" class="easyui-linkbutton"
                   onclick="resetPrompts()">–°–±—Ä–æ—Å–∏—Ç—å</a>
            </div>
        </div>

        <div title="–ü—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ–º–ø—Ç–æ–≤" style="padding:10px">
            <div class="easyui-accordion" style="width:100%;height:100%">
                <div title="–ü—Ä–æ–º–ø—Ç –¥–ª—è —Ä–µ–∂–∏–º–∞ –ß–ê–¢" style="padding:10px">
                    <div id="chat-prompt-view" style="white-space:pre-wrap;font-family:monospace;overflow:auto;height:150px"></div>
                </div>
                <div title="–ü—Ä–æ–º–ø—Ç –¥–ª—è —Ä–µ–∂–∏–º–∞ –ì–ï–ù–ï–†–ê–¶–ò–Ø" style="padding:10px">
                    <div id="generation-prompt-view" style="white-space:pre-wrap;font-family:monospace;overflow:auto;height:150px"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="search-dialog" class="easyui-dialog" title="–ü–æ–∏—Å–∫ –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π"
     style="width:500px;height:300px;padding:10px" data-options="closed:true,modal:true">
    <div style="margin-bottom:15px">
        <label>–ü–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å:</label>
        <input id="search-query" class="easyui-textbox" style="width:100%">
    </div>
    <div style="margin-bottom:15px">
        <a href="javascript:void(0)" class="easyui-linkbutton"
           onclick="performSearch()">–ò—Å–∫–∞—Ç—å</a>
    </div>
    <div id="search-results" style="margin-top:20px"></div>
</div>


<script>
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã - –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ app.js
    $(document).ready(function() {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
        if (typeof loadSystemInfo === 'function' &&
            typeof connectEventSource === 'function' &&
            typeof loadChatHistory === 'function') {
            loadSystemInfo();
            connectEventSource();
            loadChatHistory();
        } else {
            console.error('–§—É–Ω–∫—Ü–∏–∏ –∏–∑ app.js –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
            setTimeout(function() {
                // –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ 500–º—Å
                if (typeof loadSystemInfo === 'function') {
                    loadSystemInfo();
                    connectEventSource();
                    loadChatHistory();
                } else {
                    console.error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ app.js');
                }
            }, 500);
        }
    });
</script>

</body>
</html>